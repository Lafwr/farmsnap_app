<div class="info-window">
  <h5><strong><%= event.name || "Unknown Event" %></strong></h5>
  <p><strong>Location:</strong> <%= event.location %></p>

  <div class="crate-list">
    <% flash_sale_crates = crates.select(&:flash_sale) %>
    <% regular_crates = crates.reject(&:flash_sale) %>

    <% (flash_sale_crates + regular_crates).first(5).each do |crate| %>
      <div class="crate-item <%= 'flash-sale' if crate.flash_sale %>">
        <strong><%= crate.name %> by <%= crate.farmer.user.first_name %></strong> - Â£<%= crate.price %>
        <% if crate.flash_sale %>
          <span class="text-danger">ðŸ”¥ Flash Sale</span>
        <% end %>
      </div>
    <% end %>
  </div>

  <% if crates.count > 5 %>
    <p class="text-muted">+ <%= crates.count - 5 %> more crates available</p>
  <% end %>

  <p><%= link_to "View Crates at This Event", crates_path(query: event.name), class: "btn btn-sm btn-primary" %></p>
</div>
